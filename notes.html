<h2>Beleške</h2>

<div class="note-form" style="max-width:600px;margin:20px auto 40px auto;padding:20px;background:white;border-radius:12px;box-shadow:0 4px 12px rgba(0,0,0,0.05);">
  <label>Predmet:</label>
  <select id="noteSubject">
    <option value="Istorija umetnosti 1">Istorija umetnosti 1</option>
    <option value="Istorija umetnosti 2">Istorija umetnosti 2</option>
    <option value="Osnovi poslovanja">Osnovi poslovanja</option>
    <option value="CRM">CRM</option>
    <option value="HMIP">HMIP</option>
    <option value="Digitalni marketing">Digitalni marketing</option>
    <option value="Menadžment">Menadžment</option>
  </select>

  <label>Naziv beleške:</label>
  <input type="text" id="noteTitle">

  <label>Sadržaj beleške:</label>
  <textarea id="noteText" rows="4"></textarea>

  <button id="addNote">Dodaj belešku</button>
</div>

<h3 style="text-align:center;">Lista beleški po predmetima</h3>
<div id="notesList"></div>

<script>
$(document).ready(function () {
  // --- Učitavanje beleški iz localStorage ---
  let savedNotes = JSON.parse(localStorage.getItem('notes')) || {};

  function renderNotes() {
    $("#notesList").empty();
    for(let subj in savedNotes){
      let container = $(`<div class="subject-container" data-subject="${subj}"><h4 style="text-align:center;">${subj}</h4><div class="subject-notes"></div></div>`);
      container.appendTo("#notesList");
      savedNotes[subj].forEach(note=>{
        let card = $(`<div class="note-card" style="background:white;border-radius:12px;padding:20px;width:220px;box-shadow:0 4px 12px rgba(0,0,0,0.05);margin:10px auto;"><h4>${note.title}</h4><p>${note.text}</p><button class="delete-btn">Obriši</button></div>`);
        card.hide().appendTo(container.find(".subject-notes")).fadeIn(400);
      });
    }
    // update ukupno beleški
    localStorage.setItem('notesCount', Object.values(savedNotes).reduce((a,b)=>a+b.length,0));
  }

  renderNotes(); // prikaz beleški prilikom učitavanja

  // --- Dodavanje nove beleške ---
  $("#addNote").on("click", function () {
    let title = $("#noteTitle").val();
    let text = $("#noteText").val();
    let subject = $("#noteSubject").val();
    if(title=="" || text==""){ alert("Popunite sva polja"); return; }

    savedNotes[subject] = savedNotes[subject] || [];
    savedNotes[subject].push({title,text});
    localStorage.setItem('notes', JSON.stringify(savedNotes));

    $("#noteTitle").val(""); 
    $("#noteText").val("");

    renderNotes(); // refresh prikaza
  });

  // --- Brisanje beleške ---
  $("#notesList").on("click",".delete-btn",function(){
    let subj=$(this).closest(".subject-container").data("subject");
    let title=$(this).siblings("h4").text();
    savedNotes[subj] = savedNotes[subj].filter(n=>n.title!==title);
    if(savedNotes[subj].length===0) delete savedNotes[subj]; // ako nema beleški, ukloni container
    localStorage.setItem('notes',JSON.stringify(savedNotes));
    renderNotes();
  });
});
</script>
